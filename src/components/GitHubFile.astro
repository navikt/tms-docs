---
import { fetchContent } from "../utils/github";
import { marked } from "marked";

interface Props {
  repo: string; // e.g. "tms-mikrofrontend-selector" or "navikt/tms-mikrofrontend-selector"
  path: string; // e.g. "main/howto.md"
  preview?: number; // optional: show only first N chars
}

const { repo, path, preview } = Astro.props as Props;

let content = "";
try {
  content = await fetchContent(repo, path);
} catch (e) {
  content = `Failed to load ${repo}/${path}: ${e}`;
}

const text = typeof preview === "number" ? content.slice(0, preview) : content;
const renderedHtml = marked.parse(text);
---
<div set:html={renderedHtml} />
